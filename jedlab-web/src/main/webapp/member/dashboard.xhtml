<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html" template="/layout/layout.xhtml">

	<ui:define name="body">
	

		<div class="w3-content w3-margin-top" style="max-width:1400px;">
			
			<div class="w3-row-padding">
				
				<div class="w3-third">
					
					<div class="w3-white w3-text-grey w3-card-4">
						<div class="w3-display-container">
							<s:graphicImage value="#{userHome.userThumbnailImage}"
								rendered="#{userHome.student.hasImage}" 
								style="width:100%;height: 270px;" alt="#{jedLab.currentUser.username} avatar"></s:graphicImage>
							<h:graphicImage value="/images/image-text.png" rendered="#{!userHome.student.hasImage}" style="width:100%"/>	
							<div class="w3-display-bottomleft w3-container w3-text-black">
								<h2>
								  <h:outputText value="#{userHome.student.fullname}" rendered="#{not empty userHome.student.fullname}"/>
								  <s:link value="#{messages['Edit']}" view="/member/userEdit.xhtml"
								  	propagation="none"
								  	includePageParams="false"  							  	
								  	rendered="#{empty userHome.student.fullname}"/>	
								</h2>
							</div>
						</div>
						
						<div class="w3-container">
							
							<p>
								<i class="icon-mail w3-margin-right w3-large w3-text-teal"/>
								<h:outputText value="#{userHome.student.email}" />
							</p>
							
							<p>
								<i class="icon-user w3-margin-right w3-large w3-text-teal"/>
								<h:outputText value="#{userHome.student.username}" />
							</p>
							
							<p>
								<s:button view="/member/invoiceList.xhtml"
									styleClass="btn btn-green"
									propagation="none"
									includePageParams="false" 
									value="#{messages['Invoice_List']}" ></s:button>
							</p>
							
							<p>
								<h:form rendered="false">
									<h:commandButton  value="#{messages['Build_Resume']}" styleClass="btn btn-blue"/>
								</h:form>
							</p>
							
							
						</div>
						
					</div>
					<br />
				</div>
				
				
				
				 
				<div class="w3-twothird locale-direction">
					
					<div class="w3-container w3-card-2 w3-white w3-margin-bottom">

						<h2 class="w3-text-grey w3-padding-16">
							<i class="icon-books w3-margin-left w3-xxlarge w3-text-teal"></i>
							<h:outputText value="#{messages['Register_Course_List']}" rendered="#{not empty memberCourseQuery.resultList}" />
							<s:link value="#{messages['No_Member_Course']}"
								propagation="none"
								includePageParams="false"
								view="/courseList.xhtml" 
								rendered="#{empty memberCourseQuery.resultList}" /> 
						</h2>

						<s:fragment rendered="#{not empty memberCourseQuery.resultList}">
							<c:forEach items="#{memberCourseQuery.resultList}" var="_item">
	
								<div class="w3-container">
									<h5 class="w3-opacity">
										<s:graphicImage value="#{_item.image}"
										rendered="#{_item.hasImage}" width="85px" height="40px"
										styleClass="ui middle aligned tiny image">

									</s:graphicImage>
									<s:graphicImage value="/images/no_video_photo.png"
										rendered="#{!_item.hasImage}"
										styleClass="ui middle aligned small image"></s:graphicImage>
										<b><s:link view="/course.xhtml" value="#{_item.name}"
											propagation="none" includePageParams="false"
											styleClass="header clickableLink">
											<f:param name="courseId" value="#{_item.id}"></f:param>
										</s:link></b>
									</h5>
									<h6 class="w3-text-teal">									
										<span class="w3-tag w3-teal w3-round">#{_item.chapterCount} #{messages['Chapter']}</span>
									</h6>
									<p>
										<s:formattedText value="#{_item.description}"></s:formattedText>										
									</p>
									<hr />
								</div>
							
							</c:forEach>
						</s:fragment>
						
						
						<s:decorate template="/layout/seamPaging.xhtml"
							rendered="#{not empty memberCourseQuery.resultList}">
							<ui:param name="entityList" value="#{memberCourseQuery}" />
						</s:decorate>
						
					</div>
					
					
					<!-- Stories -->
					
					<div class="w3-container w3-card-2 w3-white w3-margin-bottom">
						<h2 class="w3-text-grey w3-padding-16">
							<i class="icon-book w3-margin-left w3-xxlarge w3-text-teal"></i>
							<h:outputText value="#{messages['Stories']}" rendered="#{not empty personalStoryQuery.resultList}" />
							<s:link propagation="none" includePageParams="false"
								view="/story/storyList.xhtml" 
								value="#{messages['Empty_Stories']}" rendered="#{empty personalStoryQuery.resultList}" /> 
						</h2>
						<s:fragment rendered="#{not empty personalStoryQuery.resultList}">
						
							<c:forEach items="#{personalStoryQuery.resultList}" var="_st">
							
								<div class="w3-container">
									<h5 class="w3-opacity">
										<s:graphicImage value="#{_st.image}"
										rendered="#{_st.hasImage}" width="85px" height="40px"
										styleClass="ui middle aligned tiny image">

									</s:graphicImage>
									<s:graphicImage value="/images/image-text.png"
										rendered="#{!_st.hasImage}"
										styleClass="ui middle aligned small image"></s:graphicImage>
										<b><s:link view="/story/storyEdit.xhtml" value="#{_st.title}"
											propagation="none" includePageParams="false"
											styleClass="header clickableLink">
											<f:param name="storyId" value="#{_st.id}"></f:param>
										</s:link></b>
									</h5>
									<h6 class="w3-text-teal">									
										<s:span styleClass="w3-tag w3-teal w3-round">
											<h:outputText value="#{messages['Published']}" rendered="#{_st.published}"/>
											<h:outputText value="#{messages['Draft']}" rendered="#{!_st.published}"/>
										</s:span>
									</h6>
									<p>
										<span data-storyid="#{_st.id}" class="story-img" style="cursor: pointer;color: #2F7ED8;">
													<s:fragment rendered="#{!_st.hasImage}">
														#{messages['Add']} #{messages['Image']}
													</s:fragment>
													<s:fragment rendered="#{_st.hasImage}">
														#{messages['Edit']} #{messages['Image']}
													</s:fragment>
										</span>
									</p>
									<hr />
								</div>
							
							
								
							</c:forEach>
							
							
							<c:set var="_stCount"
							value="#{personalStoryQuery.pageCount == 0 ? 1 : personalStoryQuery.pageCount}" />
						<div class="pagination">

							<s:link styleClass="page"
								rendered="#{personalStoryQuery.previousExists}"
								value="#{messages.First_Page}" >
								<f:param name="sr" value="0" />
								<f:param name="sn" value="0" />
							</s:link>

							<s:link styleClass="page"
								rendered="#{personalStoryQuery.previousExists}"
								value="#{messages.Previous_Page}" >
								<f:param name="sr"
									value="#{personalStoryQuery.previousFirstResult}" />
								<f:param name="sn" value="#{personalStoryQuery.pageNumber-1}" />
							</s:link>


							<s:span styleClass="page" style="direction:rtl;"
								rendered="#{personalStoryQuery.nextExists or personalStoryQuery.previousExists}">
								<h:outputText value="#{personalStoryQuery.pageNumber + 1}" /> #{messages['Of']} <h:outputText
									value="#{_pCount}" />
							</s:span>


							<s:link styleClass="page"
								rendered="#{personalStoryQuery.nextExists}"
								value="#{messages.Next_Page}" >
								<f:param name="sr"
									value="#{personalStoryQuery.nextFirstResult}" />
								<f:param name="sn" value="#{personalStoryQuery.pageNumber+1}" />
							</s:link>

							<s:link styleClass="page"
								rendered="#personalStoryQuery.nextExists}"
								value="#{messages.Last_Page}" >
								<f:param name="sr"
									value="#{personalStoryQuery.lastFirstResult}" />
								<f:param name="sn" value="#{personalStoryQuery.pageCount-1}" />
							</s:link>

						</div>
							
							
							
						</s:fragment>
						
						
					</div>
					
					<!-- Questions -->
					<div class="w3-container w3-card-2 w3-white">
						<h2 class="w3-text-grey w3-padding-16">
							<i class="icon-book w3-margin-left w3-xxlarge w3-text-teal"></i>
							<h:outputText value="#{messages['Solved_Question_List']}" rendered="#{not empty memberQuestionQuery.resultList}" />
							<s:link propagation="none" includePageParams="false"
								view="/coders/questionList.xhtml" 
								value="#{messages['Empty_Question_List']}" rendered="#{empty memberQuestionQuery.resultList}" /> 
						</h2>
						<s:fragment rendered="#{not empty memberQuestionQuery.resultList}">
						
							<c:forEach items="#{memberQuestionQuery.resultList}" var="_mq">
								<div class="w3-container">
											<h5 class="w3-opacity">
												<b><s:link value="#{_mq.question.title}" propagation="none"
														styleClass="clickableLink" rendered="#{!s:hasRole('Admin')}"
														includePageParams="false" view="/coders/ide.xhtml">
														<f:param name="qId" value="#{_mq.question.id}"></f:param>
													</s:link></b>
											</h5>
											<h6 class="w3-text-teal">									
												<span class="w3-tag w3-teal w3-round">#{_mq.question.points} #{messages['points']}</span>
											</h6>
											<p>
												<h:outputText value="#{_mq.question.description}" />
											</p>
											<hr />
								</div>
							</c:forEach>
							
							
							<c:set var="_pCount"
							value="#{memberQuestionQuery.pageCount == 0 ? 1 : memberQuestionQuery.pageCount}" />
						<div class="pagination">

							<s:link styleClass="page"
								rendered="#{memberQuestionQuery.previousExists}"
								value="#{messages.First_Page}" >
								<f:param name="fr" value="0" />
								<f:param name="pn" value="0" />
							</s:link>

							<s:link styleClass="page"
								rendered="#{memberQuestionQuery.previousExists}"
								value="#{messages.Previous_Page}" >
								<f:param name="fr"
									value="#{memberQuestionQuery.previousFirstResult}" />
								<f:param name="pn" value="#{memberQuestionQuery.pageNumber-1}" />
							</s:link>


							<s:span styleClass="page" style="direction:rtl;"
								rendered="#{memberQuestionQuery.nextExists or memberQuestionQuery.previousExists}">
								<h:outputText value="#{memberQuestionQuery.pageNumber + 1}" /> #{messages['Of']} <h:outputText
									value="#{_pCount}" />
							</s:span>


							<s:link styleClass="page"
								rendered="#{memberQuestionQuery.nextExists}"
								value="#{messages.Next_Page}" >
								<f:param name="fr"
									value="#{memberQuestionQuery.nextFirstResult}" />
								<f:param name="pn" value="#{memberQuestionQuery.pageNumber+1}" />
							</s:link>

							<s:link styleClass="page"
								rendered="#memberQuestionQuery.nextExists}"
								value="#{messages.Last_Page}" >
								<f:param name="fr"
									value="#{memberQuestionQuery.lastFirstResult}" />
								<f:param name="pn" value="#{memberQuestionQuery.pageCount-1}" />
							</s:link>

						</div>
							
							
							
						</s:fragment>
						
						
					</div>
					
					
					
					
					
					
					
					
					
				</div>
			
			</div>
			
		</div>
		
		
		<script>
			jQuery(document).ready(function(){
				jQuery("body").addClass("w3-light-grey");
			});
		</script>
		
		<script>
			jQuery(window).load(function(){

				jQuery(".story-img").click(function(){
					var stid = jQuery(this).data("storyid");										
					jQuery("#storyFileId").val(stid);
					jQuery("#storyFileForm\\:storyFile").click();
				});
				
			});
			
			function storyUploaderChange(){
				jQuery("#storyFileForm\\:storyBtnImageUpdate").click();
			}
		</script>    
		
		<div style="display: none;">
				<h:form enctype="multipart/form-data" id="storyFileForm">
					<input type="hidden" name="storyFileId" id="storyFileId" />
					<s:fileUpload id="storyFile" data="#{storyHome.uploadImage}"
							onchange="storyUploaderChange();" accept="images/*"
							fileSize="#{storyHome.fileSize}" />
					<h:commandButton action="#{storyHome.uploadImage()}"
							value="#{messages['Update']}" id="storyBtnImageUpdate"
							styleClass="ui primary button"></h:commandButton>
				</h:form>
		</div>
							
		
		
		


	</ui:define>


</ui:composition>
