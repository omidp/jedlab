<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" template="/layout/layout.xhtml">

	<ui:define name="head">
		<script type="text/javascript" src="#{_ctx}/js/materialize.js"> </script>
		<link href="#{_ctx}/css/materialize.css" rel="stylesheet" />
	</ui:define>

	<ui:define name="body">

		<div class="ui middle aligned equal width center aligned padded grid">

			<div class="row" id="loginPanel">

				<div class="one wide column"></div>

				<div class="four wide column">
					<div class="ui piled segment">
						<h2 class="ui teal image header">
							<div class="content">#{messages['Log_In_To_Account']}</div>
						</h2>

						<div class="ui large form">


							<div class="field">
								<s:decorate id="uField" template="/layout/edit.xhtml">
									<ui:define name="prefix">
										<i class="icon-user prefix"></i>
									</ui:define>
									<input type="text" id="uname" />									
									<ui:define name="label">
										#{messages['Email']} / #{messages['User_Name']}
									</ui:define>
								</s:decorate>
							</div>
							<div class="field">
								<s:decorate id="pField" template="/layout/edit.xhtml">
									<ui:define name="prefix">
										<i class="icon-lock prefix"></i>
									</ui:define>
									<input type="password" id="upass" />		
									<ui:define name="label">
										#{messages['Password']}
									</ui:define>
								</s:decorate>
							</div>
							<button type="button" class="btn btn-blue" id="btnLogin">#{messages['Send']}</button>
							
						</div>
					</div>
					<div class="ui bottom attached warning message">
						<i class="icon-info"></i>
						<s:link propagation="none" includePageParams="false" view="/recoverPassword.seam">#{messages['Forgot_Password']}
						</s:link>
					</div>

				</div>

				<div class="one wide column"></div>

				<div class="ui vertical divider">#{messages['Or']}</div>

				<div class="one wide column"></div>

				<div class="four wide column">
					<div class="ui piled segment">
						<h2 class="ui teal image header">
							<div class="content">#{messages['Register']}</div>
						</h2>

						<h:form id="registerForm" styleClass="ui large form">


							<div class="field">
								<s:decorate id="uEmail" template="/layout/edit.xhtml">
									<ui:define name="prefix">
										<i class="icon-mail prefix"></i>
									</ui:define>
									<h:inputText id="uemail" value="#{user.email}" required="true">
									</h:inputText>
									<ui:define name="label">
										#{messages['Email']}
									</ui:define>
								</s:decorate>

							</div>

							<h:commandButton action="#{registerAction.register()}"
								id="btnRegister" value="#{messages['Save']}"
								onclick="common.showLoading();"
								styleClass="btn btn-green" />


						</h:form>

					</div>
					<div class="ui bottom attached warning message">
						<i class="icon-info"></i>
						<s:link view="/recoverActLink.seam" propagation="none" includePageParams="false">#{messages['Recover_Act_Link']}
						</s:link>
					</div>

				</div>

				<div class="one wide column"></div>

			</div>
		</div>

		<script type="text/javascript">

								jQuery(document).ready(function(){

									jQuery("#registerForm\\:uEmail\\:uemail").on('keyup', function(e){
										if (e.keyCode == 13) { jQuery("#registerForm\\:btnRegister").click();}
									});

									jQuery("#uname").on('keyup', function(e){
										if (e.keyCode == 13) { jQuery("#btnLogin").click();}
									});

									jQuery("#upass").on('keyup', function(e){
										if (e.keyCode == 13) { jQuery("#btnLogin").click();}
									});

									jQuery("#btnLogin").click(function(){
										common.showLoading();
										jQuery("#loginForm\\:hunfield").val(jQuery("#uname").val());
										jQuery("#loginForm\\:hpfield").val(btoa(jQuery("#upass").val()));
										jQuery("#loginForm\\:btnLoginClick").click();
									});
									
									
								});
									
								</script>

		<script type="text/javascript">
			jQuery(document).ready(function(){
				Materialize.updateTextFields();
			});
			
		</script>
		
		<div style="display: none;">
			<h:form id="loginForm">
				<h:inputHidden id="hunfield" 	value="#{credentials.username}" />
				<h:inputHidden id="hpfield"	value="#{credentials.password}" />
				<h:commandButton action="#{identity.login()}" id="btnLoginClick"
								value="#{messages['Send']}" styleClass="btn btn-blue" />
			</h:form>		
		</div>

	</ui:define>
</ui:composition>
