<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" template="/layout/layout.xhtml">


	<ui:define name="head">
		<style type="text/css">
</style>

	</ui:define>

	<ui:define name="body">

		<div style="margin-top: 20px; margin-right: 10px"
			class="locale-direction">

			<s:div rendered="#{identity.loggedIn}">
					
					<button class="btn btn-big btn-round btn-red w3-margin w3-right"
						id="createCurateBtn">#{messages['Create_Page']}</button>

					<script type="text/javascript">
					

						jQuery(document).ready(function(){
							jQuery("#createCurateBtn").click(function(){
	
								jQuery("#curatePageModal").modal({
								    closable  : false,
								    onDeny    : function(){
								      jQuery("#curatePageModal").modal('hide');
								      return false;
								    },
								    onApprove : function() {
								    	curate.createCuratePage();
								    }
								  })
								  .modal('show');
	
							});
						});
	
						
						
					</script>
				
					<s:button styleClass="btn btn-big btn-round btn-green w3-margin w3-left"
						view="/curate/curateList.xhtml" propagation="none"
						includePageParams="false" value="#{messages['My_Curates']}">
						<f:param name="mc" value="Y"></f:param>
					</s:button>
					

			</s:div>

			<div style="clear: both;" />

		</div>


		


		<s:fragment rendered="#{!identity.loggedIn}">

			<div class="w3-bar locale-direction w3-margin">
				
				<s:button value="#{messages['Login_To_Create_Page']}"
					propagation="none" includePageParams="false" styleClass="btn btn-big btn-round btn-red"
					view="/member/curateList.xhtml"></s:button>
			</div>

		</s:fragment>
		
		<hr/>

		

		<s:div rendered="#{empty pageQuery.resultList}"
			styleClass="ui floating message w3-margin locale-direction">
			<p>
				<h:outputText value="#{messages['No_Curate_Result']}" />
			</p>
		</s:div>

		<s:div rendered="#{not empty pageQuery.resultList}"
			styleClass="w3-margin locale-direction">
			<ul class="w3-ul w3-card-4">

				<c:forEach var="_item" items="#{pageQuery.resultList}">

					<div class="w3-half w3-container "
					style="margin-top: 20px; float: right">

					<div class="w3-card4 w3-border">

						<div class="w3-container w3-light-grey">


							<s:graphicImage styleClass="w3-right w3-circle " style="margin-left:3px;margin-top:10px"
								height="40" width="40" value="#{_item.member.image}"
								rendered="#{_item.member.hasImage}"></s:graphicImage>

							<s:graphicImage styleClass="w3-right w3-circle" style="margin-left:3px;margin-top:10px"
								height="40" width="40" value="/images/default-avatar.jpg"
								rendered="#{!_item.member.hasImage}"></s:graphicImage>

							<div class="w3-right">

								<h3>
									<s:link view="/curate/curateEdit.xhtml" styleClass="clickableLink"
										value="#{_item.title}" 
										includePageParams="false" propagation="none">
								    	<f:param name="pageId" value="#{_item.id}"></f:param>									    
								    </s:link>
								</h3>
								<p>
									<span> <s:link style="float: right;"
											value="#{_item.member.username}"
											styleClass="clickableLink w3-margin-left" propagation="none"
											view="/story/storyList.xhtml">
											<f:param name="author" value="#{_item.member.username}"></f:param>
										</s:link>
									</span> #{_item.socialDate}

								</p>
								<br />
								
							</div>

						</div>
  
						<div class="w3-container w3-margin content-height">
							 <s:graphicImage value="#{_item.image}"  styleClass="fitimg ui small right floated image"
						    	rendered="#{_item.hasImage}">
						    		
						    </s:graphicImage> 
							
							
							<h3><h:outputText value="#{messages['Block_Count']}" /> #{' : '} <h:outputText styleClass="ui orange circular label" value="#{_item.statistic.blockCount}" />  </h3>
							<h3><h:outputText value="#{messages['View_Count']}" /> #{' : '} <h:outputText styleClass="ui orange circular label" value="#{_item.statistic.pageViewCountFormatted}" />  </h3>
							<h3><h:outputText value="#{messages['Curate_Count']}" /> #{' : '} <h:outputText styleClass="ui orange circular label" value="#{_item.statistic.curateCount}" />  </h3>
							
						</div>
						
						
 


					</div>


				</div>

				</c:forEach>

			</ul>
		</s:div>

		<s:decorate rendered="#{not empty pageQuery.resultList}"
			template="/layout/seamPaging.xhtml">
			<ui:param name="entityList" value="#{pageQuery}" />
		</s:decorate>
		
		<s:fragment rendered="#{identity.loggedIn}">
			<div class="ui modal" id="curatePageModal">
				<div class="header locale-direction w3-right-align">#{messages['Title']}</div>
				<div class="content locale-direction w3-right-align">
					<input type="text" id="curatePageTitle" />
				</div>
				<div class="actions">
					<div class="ui approve button">#{messages['Create']}</div>
					<div class="ui cancel button">#{messages['Cancel']}</div>
				</div>
			</div>

			<script>
				jQuery(document).ready(function(){
		
					jQuery("#curatePageTitle").on('keyup', function(e){
						if (e.keyCode == 13) { curate.createCuratePage();}
					});
		
				});
				
			</script>
			<script type="text/javascript" src="#{_ctx}/js/curate.js"></script>
		</s:fragment>


	</ui:define>
</ui:composition>
