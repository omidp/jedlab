<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core">


	<div style="margin-top: 20px; margin-right: 10px"
		class="locale-direction">

		<s:fragment rendered="#{s:hasRole('Admin')}">
			<s:button value="#{messages['Create']} #{messages['Course']}"
				view="/admin/courseEdit.xhtml" propagation="none"
				includePageParams="false"></s:button>

			<h:form>
				<h:inputText value="#{courseQuery.course.name}" id="courseName" />
				<h:commandButton action="#{webContext.redirectIt()}" value="Search" />
			</h:form>
			<h:dataTable value="#{courseQuery.resultList}" var="_item"
				styleClass="ui selectable celled table">

				<h:column>
					<f:facet name="header">Course Name</f:facet>
					<s:link value="#{_item.name}" view="/admin/courseEdit.xhtml"
						propagation="none" includePageParams="false">
						<f:param name="courseId" value="#{_item.id}"></f:param>
					</s:link>
				</h:column>

				<h:column>
					<f:facet name="header">Action</f:facet>
					<s:link value="#{messages['Add']} #{messages['Chapter']}"
						view="/admin/chapterEdit.xhtml" propagation="none"
						includePageParams="false">
						<f:param name="courseId" value="#{_item.id}"></f:param>
					</s:link>
				</h:column>



				<h:column>
					<f:facet name="header">Chapter List</f:facet>
					<s:link value="#{messages['List']} #{messages['Chapter']}"
						view="/admin/chapterList.xhtml" propagation="none"
						includePageParams="false">
						<f:param name="courseId" value="#{_item.id}"></f:param>
					</s:link>
				</h:column>

			</h:dataTable>


		</s:fragment>


		<s:fragment rendered="#{not s:hasRole('Admin')}">
		
		
			<s:fragment rendered="#{empty courseQuery.resultList}">
				
				<s:div styleClass="well">
					<h:outputText value="#{messages['Course_Not_Found']}" />
				</s:div>
			
			
			</s:fragment>


			<s:fragment rendered="#{not empty courseQuery.resultList}">
				
				
				
				<div class="ui link cards">

					<c:forEach items="#{courseQuery.resultList}" var="_item">
						<div class="card">
							<div class="image" onclick="gotoCourse(#{_item.id});">

								<s:graphicImage value="#{_item.image}" style="height:250px;"
									rendered="#{_item.hasImage}">
									<s:transformImageSize maintainRatio="true" height="250"></s:transformImageSize>
								</s:graphicImage>

								<s:graphicImage value="/images/no_video_photo.png"
									style="height:250px;" rendered="#{_item.hasImage == false}">
									<s:transformImageSize maintainRatio="true" height="250"></s:transformImageSize>
								</s:graphicImage>

							</div>
							<div class="content" style="cursor: default;">
								<div class="header">

									<s:link propagation="none" includePageParams="false"
										rendered="#{identity.loggedIn and s:hasRole('Admin')}"
										view="/admin/chapterEdit.xhtml" styleClass="item">
										<h:outputText value="#{_item.name}" />
										<f:param name="courseId" value="#{_item.id}"></f:param>
									</s:link>


									<h:outputText styleClass="locale-font" value="#{_item.name}"
										rendered="#{!s:hasRole('Admin')}" />

								</div>
								<div class="meta">
									#{messages['Publish_Date']} :
									<h:outputText value="#{_item.createdDate}"
										converter="#{persianDateConverter}" />
									<br />									
									 #{messages['Level']} :
									<h:outputText value="#{_item.level.label}" />
									<br />
									<h:outputText value="#{messages['Free']}"
										rendered="#{_item.free}" />
									<h:outputText value="#{_item.price}" rendered="#{!_item.free}" />
								</div>
								<div class="description">

									<h:outputText
										value="#{_item.chapterCount} #{messages['Chapter']}"
										rendered="#{_item.hasChapter}" />
									<h:outputText
										value="#{messages['Chapter']} #{messages['Has_Not']}"
										rendered="#{!_item.hasChapter}" />

								</div>
							</div>
							<div class="extra content white">
								<div style="float:left"> 
									<div class="ui label">
										  <i class="icon-eye"></i>
										  <div class="detail">
										  	<h:outputText value="#{_item.viewCount}" />
										  </div>
									</div>
									
									<div class="ui label">
										  <i class="icon-star-full"></i>
										  <div class="detail">
										  	<h:outputText value="#{_item.registeredUserCount}" />
										  </div>
									</div>
									
								</div>
								<div style="float:right"> 
								<s:link view="/seam/resource/api/c/#{_item.name}" value="#{messages['Detail']}"
									propagation="none" includePageParams="false"
									styleClass="ui label clickableLink cItem_#{_item.id}" 
									style="font-weight: bold;">									
								</s:link>
								</div>
							</div>
						</div>
					</c:forEach>

				</div>

				<script>
				function gotoCourse(itemId)
				{
					window.location = jQuery(".cItem_"+itemId).attr('href');
				}
			</script>

			</s:fragment>


		</s:fragment>

	</div>


	<s:decorate template="/layout/seamPaging.xhtml" rendered="#{not empty courseQuery.resultList}">
		<ui:param name="entityList" value="#{courseQuery}" />
	</s:decorate>

</ui:composition>
