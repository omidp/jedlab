<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core">
	<div style="min-height: 250px;">
		<s:fragment rendered="#{s:hasRole('Admin')}">

			<h:dataTable value="#{chapterQuery.resultList}" var="_item"
				styleClass="ui selectable celled table" dir="rtl">

				<h:column>
					<s:link value="#{_item.name}" view="/admin/chapterEdit.xhtml"
						propagation="none" includePageParams="false">
						<f:param name="chapterId" value="#{_item.id}"></f:param>
						<f:param name="courseId" value="#{_item.course.id}"></f:param>
					</s:link>
				</h:column>

			</h:dataTable>


			<s:button view="/admin/chapterEdit.xhtml"
				value="#{messages['Add']} Chapter" propagation="none"
				includePageParams="false">
				<f:param name="courseId" value="#{courseId}"></f:param>
			</s:button>

		</s:fragment>

		<!-- User Area -->
		<s:fragment rendered="#{not s:hasRole('Admin')}">

			<s:div styleClass="well"
				rendered="#{empty courseHome.instance.chapters}">
				<h:outputText value="#{messages['Has_Not']}" />
			</s:div>
			<s:fragment rendered="#{not empty courseHome.instance.chapters}">

				<table class="ui table" dir="rtl">
					<thead>
						<tr>
							<th>#{messages['Chapter_Name']}</th>
							<th>#{messages['Duration']} (#{messages['Minutes']})</th>
							<th>#{messages['Publish_Date']}</th>
							<th>#{messages[' ']}</th>
						</tr>
					</thead>
					<tbody>

						<c:forEach var="_item" items="#{courseHome.instance.chapters}">
							<tr class="#{_item.viewed ? 'viewed' :''}">
								<td>
									<h4 class="ui header">#{_item.name}</h4>
								</td>
								<td>#{_item.durationWithformat}</td>
								<td><h:outputText value="#{_item.createdDate}"
										converter="#{persianDateConverter}" /></td>
								<td><s:link
										rendered="#{identity.loggedIn and _item.registered}"
										propagation="none" includePageParams="false"
										styleClass="clickableLink viewIcon" view="/member/video.xhtml">
										<i class="icon-display"></i>
										<f:param name="courseId" value="#{courseId}"></f:param>
										<f:param name="chapterId" value="#{_item.id}"></f:param>
									</s:link></td>
							</tr>
						</c:forEach>

					</tbody>
				</table>

				<s:fragment
					rendered="#{identity.loggedIn and courseHome.instance.registered}">
					<script>
						jQuery(document).ready(function(){
				
							jQuery(".viewIcon").each(function( index ) {
								jQuery(this).popup({
									content : "#{messages['View']}"
								});
							});
				
						});
						
						
					</script>




				</s:fragment>


			</s:fragment>

		</s:fragment>
	</div>

</ui:composition>
