<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:jedlab="http://tasktops.com/ui">

			
			<s:fragment rendered="#{courseHome.managed and courseHome.instance.processInstanceId != null}">
				<s:div id="waitForApproval"
					styleClass="w3-panel w3-red w3-round-xlarge locale-direction w3-margin">
					<p>
						<h:outputText value="#{messages['Wait_For_Approval']}" />
					</p>
				</s:div>
			</s:fragment>
			
			<s:fragment rendered="#{courseHome.managed}">
			<div style="width: 100%;margin: 0 auto;text-align: center;" class="w3-margin-top">
					<s:graphicImage value="#{courseHome.instance.image}"						 
						 styleClass="ui medium image" rendered="#{courseHome.instance.hasImage}">
						<s:transformImageSize maintainRatio="true" height="250"></s:transformImageSize>
					</s:graphicImage>
					
				<h:outputText value="#{messages['Image']} #{messages['Has_Not']}"
						rendered="#{!courseHome.instance.hasImage}" />
			</div>			
			</s:fragment>
			
				
			
			
			<h:form id="courseForm" styleClass="form w3-margin"   enctype="multipart/form-data">
			
				<s:fragment rendered="#{courseHome.managed}">
				
					<fieldset>
						<legend>#{messages['Image']} #{messages['Course']}</legend>
			
								<s:fileUpload id="file" data="#{courseHome.uploadItem.data}"
									fileSize="#{courseHome.uploadItem.fileSize}"
									accept="images/*" />
							
						
					</fieldset>	
				
				
				</s:fragment>
			
				<fieldset>
					<legend> #{messages['Attributes']} #{messages['Course']}</legend>
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Course_Name']}</ui:define>
								<h:inputText value="#{courseHome.instance.name}"
									styleClass="w3-input" maxlength="160" required="true" />
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Level']}</ui:define>
								<h:selectOneMenu value="#{courseHome.instance.level}" id="lvl" required="true">
									<s:selectItems value="#{courseLevels}" var="_item"
										label="#{_item.label}"></s:selectItems>
									<s:convertEnum></s:convertEnum>
								</h:selectOneMenu>
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Description']}</ui:define>
								<h:inputTextarea value="#{courseHome.instance.description}" required="true"
									id="desc" />
								<ui:define name="desc">markdown support</ui:define>	
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Requirment']}</ui:define>
								<h:inputTextarea value="#{courseHome.instance.requirement}"
									id="req" />
								<ui:define name="desc">markdown support</ui:define>	
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Resources']}</ui:define>
								<h:inputTextarea value="#{courseHome.instance.resources}"
									id="res" />
								<ui:define name="desc">markdown support</ui:define>	
					</s:decorate>
				</fieldset>
				
				<fieldset>
					<legend>#{messages['Cost']}</legend>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Price']}</ui:define>
								<h:inputText id="p" value="#{courseHome.instance.price}" styleClass="w3-input" required="true">
									<f:convertNumber />
								</h:inputText>
								<ui:define name="desc">#{messages['Price_Desc']}</ui:define>
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Download_Price']}</ui:define>
								<h:inputText id="dlPrice" value="#{courseHome.instance.downloadPrice}" converter="javax.faces.Integer" styleClass="w3-input" required="true">
								</h:inputText>
								<ui:define name="desc">#{messages['Download_Desc']}</ui:define>
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml">
								<ui:define name="label">#{messages['Has_Discount']}</ui:define>
								<h:selectBooleanCheckbox value="#{courseHome.hasDiscount}" />
								<ui:define name="desc">#{messages['Discount_Desc']}</ui:define>
					</s:decorate>
					
					<s:decorate template="/layout/simpleEdit.xhtml" rendered="false">
								<ui:define name="label">#{messages['Preview']} (http)</ui:define>
								<h:inputText id="dlPrev" value="#{courseHome.preview.url}" style="direction:ltr;" styleClass="w3-input" >
								</h:inputText>
					</s:decorate>
					
				</fieldset>
				
				<s:fragment rendered="#{s:hasRole('Admin')}">
					
					<h:panelGrid columns="2" dir="rtl" style="width:100%;">
					
	
						<h:outputLabel for="active">#{messages['Active']}</h:outputLabel>
						<h:selectBooleanCheckbox value="#{courseHome.instance.active}"
							id="active" />
	
						<h:outputLabel for="active">#{messages['Sticky']}</h:outputLabel>
						<h:selectBooleanCheckbox value="#{courseHome.instance.sticky}"
							id="sticky" />
	
	
					</h:panelGrid>
					
				
				</s:fragment>
				
				
				
			
			 


				
				<h:commandButton id="save" value="#{messages['Save']} #{messages['Course']}"
					styleClass="btn btn-blue"
					action="#{courseHome.persist()}" rendered="#{!courseHome.managed}" />

				<h:commandButton id="update" value="#{messages['Update']}"
					styleClass="btn btn-blue"
					action="#{courseHome.update()}" rendered="#{courseHome.managed and courseHome.instance.processInstanceId == null}" />

			</h:form>
			
			<s:fragment rendered="#{courseHome.managed}">

		


		<hr />


		<s:fragment rendered="#{s:hasRole('Admin')}">
		<fieldset>
			<legend>#{messages['Tag']} #{messages['Course']}</legend>
			<h:form id="tagform">
				<div class="ui multiple search selection dropdown" id="selectTag">
					<input type="hidden" name="tags" /> <i class="dropdown icon"></i>
					<div class="default text">Tags</div>
					<div class="menu">
						<c:forEach var="_ti" items="#{tagQuery.resultList}">
							<div class="item" data-value="#{_ti.id}">#{_ti.name}</div>
						</c:forEach>
					</div>

				</div> 

				<h:commandButton id="submit" value="#{messages['Save']}"
					styleClass="btn btn-green w3-margin-right w3-margin-left"
					action="#{courseHome.saveTags()}" />
			</h:form>
		</fieldset>
		<script>
			jQuery(document).ready(function(){

				jQuery('#selectTag')
				  .dropdown({
					  allowAdditions: true
				  });
			
			});
		</script>
		</s:fragment>

		<hr />
		
		</s:fragment>

		

</ui:composition>
