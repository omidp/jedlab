<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:jedlab="http://tasktops.com/ui"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:omidp="http://omidbiz.com/omidp"
	xmlns:h="http://java.sun.com/jsf/html" template="/layout/dialog.xhtml">

	<ui:define name="head">
		<script type="text/javascript">
			function addCmSection(itemId)
			{
				var idSection = "cmSection_"+itemId;
				jQuery("#"+idSection).prepend(jQuery("#commentPanel").contents());
			}
			function cancelReply(itemId)
			{
				var idSection = "cmSection_"+itemId;
				jQuery("#commentPanel").prepend(jQuery("#"+idSection).contents());
			}
			function redirectToLogin()
			{
				window.top.location.href = window.location.origin +"#{_ctx}/member/course.seam?courseId="+#{courseId}; 
			}
		</script>
	</ui:define>

	<ui:define name="body">
		
		<s:fragment rendered="#{!identity.loggedIn}">
			<s:button value="#{messages['Login_For_Comment']}"
				propagation="none"
				type="button"
				includePageParams="false" 
				onclick="redirectToLogin();" styleClass="btn btn-yellow">
				<f:param name="courseId" value="#{courseId}"></f:param>
				<f:param name="from" value="iframe"></f:param>
			</s:button>
		</s:fragment>
		
		<s:fragment rendered="#{identity.loggedIn}">
			<div id="commentPanel">
				<h:form class="ui reply form">
					<div class="field">
						<h:inputTextarea value="" />
					</div>
					<h:commandButton  value="#{messages['Send']} #{messages['Reply']}" />				
				</h:form>
			</div>

		</s:fragment>
		
		
		<h4 class="ui header"><h:outputText value="#{messages['No_Comment']}" rendered="#{empty commentQuery.resultList}" />  </h4>
		
		<s:fragment rendered="#{not empty commentQuery.resultList}">
			<omidp:comment commentValues="#{commentQuery.resultList}" />
		</s:fragment>


	</ui:define>
</ui:composition>
