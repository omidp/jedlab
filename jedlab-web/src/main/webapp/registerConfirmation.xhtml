<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html" 
    template="/layout/layout.xhtml">
    
    <ui:define name="head">
		<script type="text/javascript" src="#{_ctx}/js/materialize.js"> </script>
		<link href="#{_ctx}/css/materialize.css" rel="stylesheet" />
	</ui:define>

<ui:define name="body">


		<div class="ui middle aligned equal width center aligned padded grid">

			<div class="row" id="loginPanel">
 
				<div class="one wide column"></div>

				<div class="twelve wide column">
					
					<div class="ui piled segment">
						<h2 class="ui teal image header">
							<div class="content">#{registerAction.instance.email}</div>
						</h2>

						<div styleClass="ui large form">


							<div class="field">
								<s:decorate id="uField" template="/layout/edit.xhtml">
									<ui:param name="required" value="#{true}" />
									<ui:define name="prefix">
										<i class="icon-user prefix"></i>
									</ui:define>
									<input type="text" id="username" onblur="checkAvailibility();" />									
									<ui:define name="label">
										#{messages['User_Name']}
									</ui:define>
								</s:decorate>
							</div>
							<div class="field">
								<s:decorate id="pField" template="/layout/edit.xhtml">
									<ui:param name="required" value="#{true}" />
									<ui:define name="prefix">
										<i class="icon-lock prefix"></i>
									</ui:define>
									<input type="password" id="upass"/>
									<ui:define name="label">
										#{messages['Password']}
									</ui:define>
								</s:decorate>
							</div>
							<div class="field">
								<s:decorate id="cpField" template="/layout/edit.xhtml">
									<ui:param name="required" value="#{true}" />
									<ui:define name="prefix">
										<i class="icon-lock prefix"></i>
									</ui:define>
									<input type="password" id="cpass"/>
									<ui:define name="label">
										#{messages['Confirm_Password']}
									</ui:define>
								</s:decorate>
							</div>
							<button id="btnLogin" class="btn btn-blue" type="button">#{messages['Send']}</button>


						</div>
					</div>
					
				</div>

				<div class="two wide column"></div>


			</div>
		</div>
		
		<script type="text/javascript">
			jQuery(document).ready(function(){
				jQuery("#btnLogin").click(function(){
					common.showLoading();
					jQuery("#loginForm\\:usernameField").val(jQuery("#username").val());
					jQuery("#loginForm\\:upassField").val(btoa(jQuery("#upass").val()));
					jQuery("#loginForm\\:cpassField").val(btoa(jQuery("#cpass").val()));
					jQuery("#loginForm\\:btnLoginClick").click();
				});
			});

			function checkAvailibility()
			{
				var errorMsg = "#{messages['Username_Exists']}";
				jQuery.ajax({
					  url: "#{_ctx}/checkAvailibility",
					  data: {"un":jQuery("#username").val()},
					  success: function(){console.log('suc')},
					  error: function(){
						common.notification(errorMsg, "errormsg");
					  },
					  fail: function(){console.log('fail')},
					  dataType: "text"
					});
			}
		</script>
		
		
		<div style="display: none;">
			<h:form id="loginForm">
				<h:inputHidden value="#{registerAction.instance.username}" id="usernameField" required="true" />
				<h:inputHidden  value="#{registerAction.instance.password}" required="true" id="upassField"/>
				<h:inputHidden id="cpassField" value="#{registerAction.confirmPasswd}" required="true"/>
				<h:commandButton action="#{registerAction.confirm()}" id="btnLoginClick"
								value="#{messages['Send']}" styleClass="btn btn-blue" />
			</h:form>
		</div>
	

 </ui:define>
</ui:composition>
